
  <!DOCTYPE html>


<html lang="en">
  
<!-- Mirrored from esphome.io/cookbook/endstop-cover.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 16 May 2021 03:02:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta name="description" content="An example of how to integrate covers with endstops in ESPHome.">
<meta itemprop="name" content="Template Cover with Endstops">
<meta itemprop="description" content="An example of how to integrate covers with endstops in ESPHome.">
<meta itemprop="image" content="../_images/window-open.html">
<meta name="twitter:title" content="Template Cover with Endstops">
<meta name="twitter:image:src" content="../_images/window-open.html">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@OttoWinter_">
<meta name="twitter:description" content="An example of how to integrate covers with endstops in ESPHome.">
<meta property="og:title" content="Template Cover with Endstops">
<meta property="og:image" content="../_images/window-open.html">
<meta property="og:type" content="website">
<meta property="og:description" content="An example of how to integrate covers with endstops in ESPHome.">

    <title>Template Cover with Endstops &#8212; ESPHome</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="canonical" href="endstop-cover.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Etekcity Voltson (ESW01-EU)" href="esw01-eu.html" />
    <link rel="prev" title="Dual relay cover motor control" href="dual-r2-cover.html" />
  <link rel="stylesheet" href="../_static/customf001.css?hash=f908c2b5" type="text/css" />
  <link rel="apple-touch-icon" sizes="180x180" href="../_static/apple-touch-icon.png">
  <link rel="shortcut icon" href="../_static/favicon.ico">
  <link rel="icon" type="image/png" sizes="512x512" href="../_static/favicon-512x512.png">
  <link rel="icon" type="image/png" sizes="256x256" href="../_static/favicon-256x256.png">
  <link rel="icon" type="image/png" sizes="192x192" href="../_static/favicon-192x192.png">
  <link rel="icon" type="image/png" sizes="128x128" href="../_static/favicon-128x128.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../_static/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../_static/favicon-16x16.png">
  <link rel="manifest" href="../_static/site.webmanifest">
  <link rel="mask-icon" href="../_static/safari-pinned-tab.svg" color="#646464">
  <meta name="apple-mobile-web-app-title" content="ESPHome">
  <meta name="application-name" content="ESPHome">
  <meta name="msapplication-TileColor" content="#dfdfdf">
  <meta name="msapplication-config" content="/_static/browserconfig.xml">
  <meta name="theme-color" content="#dfdfdf">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta property="og:site_name" content="ESPHome">
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index-2.html">
              <img class="logo" src="../_static/logo-text.svg" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="https://esphome.io/search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../index-2.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Template Cover with Endstops</a><ul>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="template-cover-with-endstops">
<h1>Template Cover with Endstops<a class="headerlink" href="#template-cover-with-endstops" title="Permalink to this headline">¶</a></h1>
<p>The following is an example configuration for controlling covers (like window blinds etc)
with ESPHome. This guide assumes that the cover is set up with two endstops at the top
and the bottom. When these endstops are reached, the cover will automatically stop.</p>
<p>To protect the motors from spinning indefinitely (in case an endstop fails) the motors
also have a maximum run time - after 3 minutes they will automatically turn off even if the
endstop is not reached.</p>
<p>ESPHome uses Home Assistant’s cover architecture model which has two states: “OPEN” or
“CLOSED”. We will map OPEN to “cover is at the top endstop” and CLOSE to “cover is at the bottom”.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">switch</span><span class="p">:</span>
  <span class="c1"># The switch that turns the UP direction on</span>
  <span class="p p-Indicator">-</span> <span class="nt">platform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gpio</span>
    <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">D1</span>
    <span class="nt">id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">up_pin</span>
    <span class="c1"># Use interlocking to keep at most one of the two directions on</span>
    <span class="nt">interlock</span><span class="p">:</span> <span class="nl">&amp;interlock_group</span> <span class="p p-Indicator">[</span><span class="nv">up_pin</span><span class="p p-Indicator">,</span> <span class="nv">down_pin</span><span class="p p-Indicator">]</span>
    <span class="c1"># If ESP reboots, do not attempt to restore switch state</span>
    <span class="nt">restore_mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always off</span>

  <span class="c1"># The switch that turns the DOWN direction on</span>
  <span class="p p-Indicator">-</span> <span class="nt">platform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gpio</span>
    <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">D2</span>
    <span class="nt">id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">down_pin</span>
    <span class="nt">interlock</span><span class="p">:</span> <span class="nv">*interlock_group</span>
    <span class="nt">restore_mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always off</span>


<span class="nt">binary_sensor</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">platform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gpio</span>
    <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">D4</span>
    <span class="nt">id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">top_endstop</span>
  <span class="p p-Indicator">-</span> <span class="nt">platform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gpio</span>
    <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">D5</span>
    <span class="nt">id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bottom_endstop</span>

<span class="nt">cover</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">platform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">endstop</span>
    <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;My</span><span class="nv"> </span><span class="s">Endstop</span><span class="nv"> </span><span class="s">Cover&quot;</span>
    <span class="nt">id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my_cover</span>
    <span class="nt">open_action</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">switch.turn_on</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">up_pin</span>
    <span class="nt">open_duration</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2min</span>
    <span class="nt">open_endstop</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">top_endstop</span>

    <span class="nt">close_action</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">switch.turn_on</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">down_pin</span>
    <span class="nt">close_duration</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2min</span>
    <span class="nt">close_endstop</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bottom_endstop</span>
    <span class="nt">stop_action</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">switch.turn_off</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">up_pin</span>
      <span class="p p-Indicator">-</span> <span class="nt">switch.turn_off</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">down_pin</span>
    <span class="nt">max_duration</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3min</span>
</pre></div>
</div>
<p>You can then optionally also add manual controls to the cover with three buttons:
open, close, and stop.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">binary_sensor</span><span class="p">:</span>
  <span class="c1"># [...] - Previous binary sensors</span>
  <span class="p p-Indicator">-</span> <span class="nt">platform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gpio</span>
    <span class="nt">id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">open_button</span>
    <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">D3</span>
    <span class="nt">on_press</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">cover.open</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my_cover</span>
  <span class="p p-Indicator">-</span> <span class="nt">platform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gpio</span>
    <span class="nt">id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">close_button</span>
    <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">D6</span>
    <span class="nt">on_press</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">cover.close</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my_cover</span>
  <span class="p p-Indicator">-</span> <span class="nt">platform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gpio</span>
    <span class="nt">id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">stop_button</span>
    <span class="nt">pin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">D7</span>
    <span class="nt">on_press</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">cover.stop</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my_cover</span>
</pre></div>
</div>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../guides/automations.html"><span class="doc">Automations and Templates</span></a></p></li>
<li><p><a class="reference internal" href="../components/cover/template.html"><span class="doc">Template Cover</span></a></p></li>
<li><p><a class="reference internal" href="dual-r2-cover.html"><span class="doc">Dual relay cover motor control</span></a></p></li>
<li><p><a class="reference external" href="https://github.com/esphome/esphome-docs/blob/current/cookbook/endstop-cover.rst">Edit this page on GitHub</a></p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
  <div id="upgrade-footer">
    A new version has been release since you last visited this page: 1.17.2 🎉
    <div class="footer-button-container">
      <div role="button" id="upgrade-footer-dismiss" class="footer-button">Dismiss</div>
      <a id="upgrade-footer-changelog" class="footer-button" href="../changelog/v1.17.0.html">View Changelog</a>  
    </div>
  </div>
  <script>
    var old = window.localStorage.getItem("version");
    if (old === null) { window.localStorage.setItem("version", "1.17");
    } else if (old !== "1.17") {
      const footerEl = document.getElementById("upgrade-footer");
      footerEl.classList.add("not-hidden");
      footerEl.addEventListener('click', function () {
        window.localStorage.setItem("version", "1.17");
        footerEl.classList.remove("not-hidden");
      });
    }
  </script>

  </body>

<!-- Mirrored from esphome.io/cookbook/endstop-cover.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 16 May 2021 03:02:41 GMT -->
</html>